---
# Example rule to send alerts to Elasticsearch
name: proc_creation_win_mshta_susp_child_processes_HIGH
type: any
es_host: es-01
es_port: 9200
index: winlogbeat-*
filter:
- query:
    bool:
      must: []
      filter:
      - match_phrase:
          event_id: '1'
      - match_phrase:
          parent_image_path: mshta.exe
      - bool:
          should:
          - match_phrase:
              image_path: cmd.exe
          - match_phrase:
              image_path: powershell.exe
          - match_phrase:
              image_path: pwsh.exe
          - match_phrase:
              image_path: wscript.exe
          - match_phrase:
              image_path: cscript.exe
          - match_phrase:
              image_path: sh.exe
          - match_phrase:
              image_path: bash.exe
          - match_phrase:
              image_path: reg.exe
          - match_phrase:
              image_path: regsvr32.exe
          - match_phrase:
              image_path: bitsadmin.exe
          minimum_should_match: 1
      should: []
      must_not: []

alert:
- "debug"

## Ref : https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mshta_susp_child_processes.yml